# 네트워크 기초

> 네트워크 : 노드와 링크가 서로 연결되어있거나 그렇지 않은 집합체.
> 
- 노드 : 서버, 라우터, 스위치 등 네트워크 장치
- 링크 : 유선, 무선

### 좋은 네트워크

많은 처리량, 짧은 지연시간, 적은 장애 빈도, 좋은 보안

### 처리량 :

링크를 통해 전달되는 단위시간당 데이터 양.

단위 : bps(bits per second). 초당 전송or수신되는 비트 수

트래픽, 장치 간 대역폭, 에러, 하드웨어 스펙에 영향 받음.

- 대역폭 : 주어진 시간동안 연결 통해 흐를 수 있는 최대 비트 수.

### 지연 시간 :

특정 메시지가 왕복하는데에 걸린 시간.

매체 타입, 패킷 크기, 라우터의 패킷 처리시간에 영향 받음.

## 네트워크 토폴리지

노드-링크의 연결 방식

### 트리 토폴리지

- 노드의 추가-삭제 쉬움.
- 특정 노드에 트래픽 집중시, 하위 노드 영향 받을 수 있음.

### 버스 토폴리지

근거리 통신망(LAN)에서 사용

장점 :

- 설치비용 적음, 우수한 신뢰성, 노드 추가-삭제 쉬움.

단점 :

- 스푸핑 문제 - 올바른 수신부로 가야할 패킷을 악의적인 노드에 전달시킴

### 스타 토폴리지

중앙에 있는 노드에 모든 노드를 연결.

장점 :

- 노드 추가, 에러 탐지 쉬움, 패킷 충돌 발생 가능성 적음.
- 장애 노드가 중앙 노드가 아닐 경우 다른 노드에 영향 끼침 적음.

단점 :

- 중앙 노드 장애시 전체 사용 불가.
- 비싼 설치 비용

### 링형 토폴리지

각각의 노드가 양 옆의 노드와 연결.

장점 :

- 충돌 발생 가능성 적음, 노드 고장 발견 쉬움.

단점 :

- 네트워크 구성 변경 어려움, 회선 장애 발생시 전체 네트워크에 영향.

### 메시 토폴리지

그물망처럼 연결

장점 :

- 한 단말 장치에 장애 발생되어도 네트워크 계속 사용 가능, 트래픽 분산 처리 가능

단점 :

- 노드 추가 어려움, 구축-운영 비용 비쌈

### 병목 현상

토폴리지가 중요한 이유는, 병목 현상을 찾을 때 중요한 기준이 되기 때문.

ex) 특정 서비스에서 대역폭을 크게 설정했는데도 성능 개선아 안됨 → 토폴리지 확인 후 회선 추가하여 병목현상 해결

## 네트워크 규모 분류

### LAN

- 근거리 통신망
- 건물 내, 캠퍼스 내 같은 좁은 공간에서 운영.
- 전송 속도 빠름, 혼잡하지 않음

### MAN

- 도시 범위
- 평균 전송 속도, LAN보다 혼잡

### WAN

- 광역 네트워크
- 국가, 대륙 범위
- 가장 느린 속도, 가장 혼잡

# TCP/IP 4계층

internet protocol suite : 컴퓨터들이 정보를 주고받는 데 쓰이는 프로토콜의 집합.

## 애플리케이션 계층 :

응용 프로그램이 사용되는 프로토콜 계층. 웹 서비스, 이메일 등 실질적 서비스 제공.

FTP : 장치간 파일 전송에 사용

SSH : 보안되지 않은 네트워크에서 네트워크 서비스 안전하게 운영하기 위한 암호화 네트워크 프로토콜

HTTP : 웹사이트 이용시 쓰이는 프로토콜

SMTP : 전자 메일 전송 위한 인터넷 표준 통신 프로토콜

DNS : 도메인 이름 - IP 주소 매핑해주는 서버. IP 주소 변경되어도 사용자에게 같은 도메인 주소로 서비스 가능.

## 전송 계층 :

송신자 - 수신자 연결하는 통신 서비스 제공.

TCP : 패킷 순서 보장, 수신여부 확인 O, 가상회선 패킷 교환 방식 사용.

UDP : 순서 보장 X, 수신여부 확인 X, 단순히 데이터만 주는 데이터그램 패킷 교환 방식

가상회선 패킷 교환 방식: 각 패킷에 가상회선 식별자 포함. 모든 패킷 전송시 가상회선 해제, 순서대로 도착.

데이터그램 패킷 교환 방식 : 패킷이 독립적으로 이동, 최적의 경로 선택, 서로 다른 경로로 전송 가능. 순서 보장 X.

### TCP 연결 - 3way handshake

1. 클라이언트 - ISN 담은 SYN 전송

ISN - 새로운 TCP 연결의 첫 번째 패킷에 할당된 임의의 시퀀스 번호.

1. 서버 - SYN + ACK ( 서버의 ISN + 클라이언트의 ISN+1)
2. 클라이언트 - ACK ( 서버의 ISN+1 )

UDP는 해당 과정 X → 신뢰성 없는 계층.

### TCP 연결 해제 - 4way handshake

1. 클라이언트 - FIN 세그먼트, FIN_WAIT_1 상태로 응답 대기
2. 서버 - ACK 보냄, CLOSE_WAIT 상태. 클라이언트가 응답 받으면 클라이언트-CLOSE_WAIT_2
3. 서버 - ACK 보냄, 일정 시간 후 클라이언트에 FIN 세그먼트 보냄
4. 클라이언트 - TIME_WAIT 상태. 서버로 ACK 보내서 서버 CLOSED상태. 클라이언트 대기후 CLOSED → 모든 연결 해제.

TIME_WAIT : 소켓 바로 소멸하지 않고 일정시간 유지되는 상태.

이유 : 지연 패킷 처리 못할시 무결성 문제

## 인터넷 계층

장치로부터 받은 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용.

- IP, ARP, ICMP
- 비연결형 특징 - 상대방이 제대로 받았는지 보장 X

## 링크 계층

전선, 광섬유, 무선 등 실질적으로 데이터를 전달.

유선 LAN - 전이중화 통신 사용

전이중화 통신 : 양쪽 장치가 동시에 송수신할 수 있는 방식

무선 LAN - 반이중화 통신 사용

반이중화 통신 : 서로 통신 가능, 동시 X. 한 번에 한 방향만 통신.

## PDU

계층 - 계층 데이터 전달시 한 덩어리 단위

구성 : 헤더(제어 관련 정보) + 페이로드 (데이터)

### 각 계층 용어

애플리케이션 계층 - 메시지

전송 계층 - 세그먼트(TCP), 데이터그램(UDP)

인터넷 계층 - 패킷

링크 계층 - 프레임(데이터 링크 계층), 비트(물리 계층)

## 애플리케이션 계층 처리하는 기기

L7 스위치 : 로드밸런서라고도 하며, 서버의 부하 분산.

시스템이 처리할 수 있는 트래픽 증가를 목표.
// eee

- URL, 서버, 캐시, 쿠키를 기반으로 트래픽 분산
- 바이러스, 불필요한 외부 데이터 필터링 기능 포함 → 응용 프로그램 수준의 트래픽 모니터링 가능.
- 장애 발생한 서버 제외 → 헬스 체크 통한 감시

인터넷 계층의 L4 스위치 :

- IP, Port 기반 트래픽 분산

헬스 체크 :

전송 주기, 재전송 주기 설정하여 반복적으로 서버에 요청 보냄.

TCP, HTTP 등 여러 방법으로 요청 → 정상적으로 이루어질시 정상적인 서버로 판별.

ex) TCP 요청 보냈는데 3way handshake 일어나지 않으면 정상 X 서버.

로드밸런서 이용한 서버 이중화 :

2대 이상의 서버 필수 → 하나의 서버에 장애 발생해도 정상 운영 위함.

로드밸런서가 가상 IP 제공하고, 뒷 단의 진짜 IP 주소 서버로 서빙.

## 인터넷 계층 처리 기기

라우터 :

여러 네트워크를 연결, 분할, 구분.

- 다른 네트워크에 존재하는 장치끼리 데이터를 주고받을 때 패킷 소모 최소화.
- 경로 최적화하여 최소 경로로 패킷 포워딩

L3 스위치 :

L2 스위치 + 라우팅 기능 포함.

L3 = 라우터 무방.

- SW-HW 기반 라우팅 중, HW 기반 라우팅

|  | L2 스위치 | L3 스위치 |
| --- | --- | --- |
| 참조 테이블 | MAC 주소 테이블 | 라우팅 테이블 |
| 참조 PDU | 이더넷 프레임 | IP 패킷 |
| 참조 주소 | MAC 주소 | IP 주소 |

## 데이터링크 계층 처리 기기

L2 스위치 :

MAC 주소를 MAC주소 테이블 통해 관리.

연결된 장치로부터 패킷 오면 패킷 전송.

IP 주소 이해 못해 IP 기반 라우팅 불가능. 단순 MAC 주소 읽어 스위칭 담당.

목적지가 MAC 주소 테이블에 없으면 전체 포트에 전달.

브리지 :

두 개의 LAN을 상호 접속 가능토록 하는 연결 장치

포트-포트 다리 역할. 받아온 MAC 주소를 MAC 주소 테이블로 관리.

## 물리 계층 처리 기기

NIC :

LAN 카드로도 불림.

- 2대 이상의 컴퓨터 네트워크 구성에 사용.
- 빠른 속도로 데이터 송수신 할 수 있도록 컴퓨터 내에 설치하는 확장 카드
- 각 LAN카드에 고유 식별번호인 MAC 주소 포함.

리피터 :

약해진 신호를 증폭하여 다른 쪽으로 전달

AP :
패킷을 복사하는 기기

- AP에 유선 LAN 연결한 후 다른 장치에서 무선 LAN(와이파이) 사용하여 무선 네트워크 연결.

# IP 주소

## ARP

IP는 가상주소이기에, MAC 주소로 변경해야함.

ARP : 변경 돕는 프로토콜

RARP : MAC → IP

### ARP 과정

1. 특정 장치가 브로드캐스트 ARP 요청.
2. 해당 IP 주소의 장치가 MAC주소 반환하여 유니캐스트 ARP reply.

브로드캐스트 : 연결된 모든 호스트에 전송

유니캐스트 : 1:1 데이터 전송